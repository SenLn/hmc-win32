# 更新日志

模块的api更新日志 更新速度优先于模块用法 API合集



### 2023年3月18日 版本号：1.2.8

- **hasPortTCP** 判断TCP(服务)端口号正在使用/系统占用  （反向理解：为true的话不能创建端口绑定）
- **hasPortUDP** 判断UDP端口号正在使用/系统占用（反向理解：为true的话不能创建端口绑定）



### 2023年3月15日 版本号：1.2.7

##### 内联API

- *内联api是为了实现一个复杂功能而创建的内联函数 不会声明详细用法，因为他单独使用可能会导致程序奔溃*

- **installKeyboardHook** 
- **installHookMouse**  
- **unHookMouse** 
- **unKeyboardHook**
- **getKeyboardNextSession** 
- **getMouseNextSession** 
- **isStartHookMouse** 
- **isStartKeyboardHook**  

##### 窗口API

- **setWindowTitleIcon**  设置标题窗口图标icon
- **getWindowClassName** 获取窗口类名
- **getAllWindowsHandle**  获取所有窗口的句柄 **增加一个参数** 是否要求必须为窗口
- **setForegroundWindow**  设置窗口聚焦
- **getAllWindows** 默认使用 *isWindows* 为true
- **getWindowStyle**  获取窗口类关联代码

##### 自动化

- **keyboardHook** 低级键盘输入变化获取
- **mouseHook** 低级鼠标位置变化获取

##### HMC内部可调用API

* **_SET_HMC_DEBUG**  HMC调试模式  打开以后会正常执行代码 但是会打印报错内容到控制台 console.error(new Error( HMC 内部错误定义 )) 例如 设置标题 设置错误 只返false 打开以后会打印详细的错误内容

##### WebView2

- **getWebView2Info**  当前安装的WebView2 信息
- **hasWebView2** 当前电脑是否安装了 WebView2
- **WebView2OnlineInstall** 在线安装WebView2



### 2023年2月14日 版本号：1.2.0

##### 窗口API

- **getAllWindows** 重写将数据获取变为读取时获取 以解决获取消耗过大问题
- **setShowWindow** 通过句柄设置窗口显示状态
- **setWindowTitle** 设置此句柄的标题
- **getWindowTitle** 获取此句柄的标题
- **isInMonitorWindow** 判断句柄的窗口是否在所有窗口的范围中(无论他是否被其他窗口挡住)
- **isMouseMonitorWindow** 判断句柄的窗口是否在鼠标所在的窗口

##### 系统相关

- **getSystemMetricsLen** 当前电脑有几块屏幕

- **getCurrentMonitorRect** 鼠标所在的屏幕的位置信息

-  **getDeviceCapsAll** 获取所有屏幕的位置

##### [函数归类]()

-  **Window** 所有窗口操作方法的归类合集 (拥有统一化名称)

- **Watch** 所有监听函数的合集 (拥有统一化名称)

-  **Clipboard** 剪贴板工具集  (拥有统一化名称)

- **Auto** 自动化工具集   (拥有统一化名称)

- **Usb** USB 控制的归档   (拥有统一化名称)

- **Shell** 实用工具集   (拥有统一化名称)

- **Process** 进程操作合集   (拥有统一化名称)

-  **registr** 注册表编辑合集   (拥有统一化名称)

##### 其他优化

- 重构代码 使用esbuld编译支持到node8 （编译时不添加支持库）

- 解决其他系统平台导入冲突

- 将原先类构建转为平放状态

- 添加命令行解析

- 添加函数归类 分辨更快



### 2023年2月11日  版本号：1.1.0

##### 系统相关

- **deleteFile** 将文件放进回收站

-  **trash** 将文件放进回收站

-  **isRegistrTreeKey** 判断该键值是否存在子项

-  **removeStringTree**  删除一个文件夹键值

-  **getConsoleHandle** 获取node控制台的句柄

-  **hideConsole**   隐藏node控制台

-  **showConsole**  显示node控制台

##### **窗口API**

-  **enumChildWindows**   枚举句柄的子窗口并返回句柄列表



### 2023年2月11日  版本号：1.0.8

##### 系统相关

-  **getUsbDevsInfo** 获取所有usb驱动器(不包含HUD)

-  **setClipboardFilePaths** 向剪贴板写入文件列表

-  **getClipboardFilePaths** 向剪贴板读取文件列表



### 2023年2月10日  版本号：1.0.7

##### 注册表编辑

-  **removeStringRegKeyWalk** 删除一个文件夹键值

-  **removeStringRegKey** 删除一个文件夹key

-  **removeStringRegValue** 删除一个值

-  **setRegistrDword** 设置一个32位数字

-  **setRegistrQword** 设置一个64位数字

-  **getRegistrDword** 获取一个32位数字

-  **getRegistrQword** 获取一个64位数字

##### 系统相关

-  **freePort**  获取一个随机的空闲的端口

-  **systemChcp** 当前系统shell的chcp信息

##### 文件链接/快捷方式

-  **createSymlink** 创建一个软链接

-  **createDirSymlink** 创建一个文件夹软链接

-  **createHardLink** 创建一个硬链接

##### 其他优化

- 不再附带C++和ts的原始代码 请自行到GitHub下载



### 2023年2月3日  版本号：1.0.6

##### **窗口API**

-  **WatchWindowPoint** 当鼠标所在的窗口变更的时候发生回调

-  **WatchWindowForeground** 当聚集的窗口变更的时候发生回调

-  **getAllWindowsHandle** 获取所有句柄 并返回一个HWND 的伪数字方法集 （getAllWindows 的替代 获取 200000次进程无影响）

-  **HWND** (类) Number(伪)
  -  **HWND** number  真实的句柄

  -  **closed** 强制结束句柄

  -  **close** 向窗口发送关闭的消息

  -  **rect** 窗口位置 (访问时自动获取)

  -  **title** 标题 (访问时自动获取)

  -  **setTitle** 设置标题

  -  **exists** 句柄是否有效 (访问时自动获取)

  -  **isHandle** 句柄是否有效 (访问时自动获取)

  -  **pid** 句柄的附属进程id (访问时自动获取)

  -  **MianPid** 句柄的 主线程/主进程 id (访问时自动获取)

  -  **MainHandle** 主句柄

  -  **isVisible** 可见性

  -  **kill** 结束 主进程/主线程

  -  **hide** 隐藏

  -  **show** 显示

  -  **setMin** 最小化

  -  **setMax** 最大化

  -  **setRestore** 恢复最近的状态

  -  **setFocus** 聚集

  -  **setEnabled** 禁用

  -  **isEnabled** 是否禁用

  -  **setJitter** 窗口抖动

  -  **isTop** 是否顶设

  -  **setTopOrCancel** 取消顶设 / 设置顶设

  -  **setOpacity** 设置 不透明度 0-100 / 0.0-1.0

  -  **setTransparent** 设置 不透明度


##### 进程控制

-  **hasProcess** 判断进程id 是否存在

-  **killProcessName** 结束该名称 /(正则)匹配的 进程

-  **processWatchdog** 当监察的进程结束时候执行回调

-  **getProcessNameList** 获取该名称 /正则匹配的进程列表

-  **getDetailsProcessNameList** 获取该名称 /正则匹配的进程列表 带执行文件路径 慢20ms

#####  系统相关

-  **alert** 方法用于显示带有一条指定消息和一个 确认 按钮的警告框

-  **confirm** 方法用于显示带有一条指定消息和 确认 和取消 的按钮的消息框

-  **MessageStop** 方法用于显示带有一条指定消息和一个 确认 按钮的和❌（X）的消息框

-  **MessageError** 方法用于显示带有一条指定消息和一个 确认 按钮的错误框 附带有❗ 感叹号。

-  **openExternal** 在资源管理器中打开该文件并选中

-  **openURL**  在默认浏览器中打开该链接

-  **openPath**  在系统默认的关联软件中打开此文件

##### 电源控制

- **powerControl** 电源控制 (原基础上新增)
- **1001** 关机
  
- **1002** 重启
  
- **1003** 注销
  
- **1005** 锁定
  
- **shutDown** 关机
  
- **restart** 重启
  
- **cancellation** 注销
  
- **lock** 锁定

##### **注册表编辑**

- **openRegKey** 打开该路径并返回方法的封装
- **listRegistrPath** 将该路径下的内容以objcet 的方式显示
- **registr** 注册表处理的集合
- **analysisDirectPath** 将一条完整的注册表路径 转为 数组 拆分为 [ *HKEY*: HKEY, *Path*: string, *key*?: string]
- **has**
- **get**
- **remove**
- **keys**
- **list**
- **create**
- **open**